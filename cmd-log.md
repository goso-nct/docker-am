# ver 1  
```
print("Hello, World !")
```

Создаём имадж для приложения:  
(venv) vg@ubu20box:~/PycharmProjects/docker$ **docker build -t hello-world .**  
```
Sending build context to Docker daemon  13.84MB
Step 1/5 : FROM python:3.8
3.8: Pulling from library/python
d960726af2be: Pulling fs layer 
...
a181a2736d7a: Pull complete 
Digest: sha256:a1563de7f9c8c47357637a646bc14eef26a16512ec7133c36e3f186a466aba7b
Status: Downloaded newer image for python:3.8
 ---> e7d3be492e61
Step 2/5 : RUN mkdir -p /usr/src/app/
 ---> Running in 330cc99ffd5d
Removing intermediate container 330cc99ffd5d
 ---> 5ebcd8ee4002
Step 3/5 : WORKDIR /usr/src/app/
 ---> Running in 2fc66984b07d
Removing intermediate container 2fc66984b07d
 ---> ab46b95e2a4b
Step 4/5 : COPY . /usr/src/app/
 ---> 7c4668f8a9a6
Step 5/5 : CMD ["python", "app.py"]
 ---> Running in b75d30d414dc
Removing intermediate container b75d30d414dc
 ---> 4752cbc47225
Successfully built 4752cbc47225
Successfully tagged hello-world:latest
```

(venv) vg@ubu20box:~/PycharmProjects/docker$ **docker images**
```
REPOSITORY    TAG       IMAGE ID       CREATED          SIZE
hello-world   latest    4752cbc47225   18 minutes ago   896MB
python        3.8       e7d3be492e61   2 weeks ago      883MB
hello-world   <none>    d1165f221234   3 months ago     13.3kB
```
(нижний hello это тест докера)  

Запускаем:  
(venv) vg@ubu20box:~/PycharmProjects/docker$ **docker run hello-world:latest**
```
Hello, World !
```

Смотрим контейнеры:  
(venv) vg@ubu20box:~/PycharmProjects/docker$ **docker ps -a**
```
CONTAINER ID   IMAGE                COMMAND           CREATED             STATUS                         PORTS     NAMES
0325ec4e10ec   d1165f221234         "/hello"          32 minutes ago      Exited (0) 32 minutes ago                affectionate_proskuriakova
27ff7f73a89b   hello-world          "python app.py"   33 minutes ago      Exited (0) 33 minutes ago                infallible_shannon
eee6f9a9b057   hello-world:latest   "python app.py"   34 minutes ago      Exited (0) 34 minutes ago                objective_bhaskara
de69aaf2bd26   d1165f221234         "/hello"          About an hour ago   Exited (0) About an hour ago             great_moser
```

Удаляем контейнер:  
(venv) vg@ubu20box:~/PycharmProjects/docker$ **docker rm de69aaf2bd26**
```
de69aaf2bd26
```
Удаляем контейнеры:  
(venv) vg@ubu20box:~/PycharmProjects/docker$ **docker rm $(docker ps -qa)**
```
0325ec4e10ec
27ff7f73a89b
```

# ver 2 cycle  
```
while True:  
  print("Hello, World !")  
  time.sleep(1)  
```

vg@ubu20box:~/PycharmProjects/docker-am$ **docker build -t hello-world .**  
```
Sending build context to Docker daemon  13.91MB  
Step 1/5 : FROM python:3.8  
 ---> e7d3be492e61  
Step 2/5 : RUN mkdir -p /usr/src/app/  
 ---> **Using cache**  
 ---> 5ebcd8ee4002  
...  
Successfully tagged hello-world:latest
```

vg@ubu20box:~/PycharmProjects/docker-am$ **docker run --name hello -d hello-world**
```
ebc017befa6441609400d3458a10058a13147581d02db6561d07b9ea28c357de
```

vg@ubu20box:~/PycharmProjects/docker-am$ **docker ps**
```
CONTAINER ID   IMAGE         COMMAND           CREATED          STATUS         PORTS     NAMES
ebc017befa64   hello-world   "python app.py"   11 seconds ago   Up 9 seconds             hello
```

vg@ubu20box:~/PycharmProjects/docker-am$ **docker stop hello**  
```
hello
```

vg@ubu20box:~/PycharmProjects/docker-am$ **docker ps -a**
```
CONTAINER ID   IMAGE         COMMAND           CREATED         STATUS                        PORTS     NAMES
ebc017befa64   hello-world   "python app.py"   4 minutes ago   Exited (137) 30 seconds ago             hello
```
_Status 137_ т.к. погасили стопом  

Для автоматического удаления контейнера после его отработки:  
docker run --name hello -d **--rm** hello-world

# ver 3  web  
```
web-app on flask  

pip install -r requirements.txt  
```

vg@ubu20box:~/PycharmProjects/docker-am$ **docker build -t web-hello .**
Sending build context to Docker daemon  13.92MB  
Step 1/7 : FROM python:3.8  
 ---> e7d3be492e61  
...
WARNING: Running pip as root will break packages and permissions. You should install packages reliably by using venv: https://pip.pypa.io/warnings/venv  
...  
Successfully built b3c66a6fe903  
Successfully tagged web-hello:latest  

vg@ubu20box:~/PycharmProjects/docker-am$ **docker run --name web -p 8080:8080 --rm web-hello**
  Serving Flask app 'app' (lazy loading)  
  Environment: production  
  ...  
  Running on http://172.17.0.2:8080/ (Press CTRL+C to quit)  
  ...  
  Hello, World! Now: - 10.06.2021 **19**:36:44 д.б. 22  

# folder

```
docker run --rm --name web -p 8080:8080 -e TZ=Europe/Moscow -v /home/vg/PycharmProjects/docker-am/resources:/usr/src/app/resources web-hello
```
изменил файл responce.json, получил:  
Hello, World! Now **in Moscow**: - 10.06.2021 23:05:05  

# volume

Docker volumes are file systems mounted on Docker containers to preserve data generated by the running container. The volumes are stored on the host, independent of the container life cycle. This allows users to back up data and share file systems between containers easily.

vg@ubu20box:~/PycharmProjects/docker-am$ **docker volume create my_volume**    
vg@ubu20box:~/PycharmProjects/docker-am$ **docker volume ls**
```
DRIVER    VOLUME NAME
local     my_volume
```
  
vg@ubu20box:~/PycharmProjects/docker-am$ **docker volume inspect my_volume**  
```
[
    {
        "CreatedAt": "2021-06-10T23:49:12+03:00",
        "Driver": "local",
        "Labels": {},
        "Mountpoint": "/var/lib/docker/volumes/my_volume/_data",
        "Name": "my_volume",
        "Options": {},
        "Scope": "local"
    }
]
```
vg@ubu20box:~/PycharmProjects/docker-am$ **docker run --rm --name web -p 8080:8080 -v my_volume:/usr/src/app/resources web-hello**  
vg@ubu20box:~$ cd /var/lib/docker/volumes/my_volume/_data  
vg@ubu20box:/var/lib/docker/volumes/my_volume/_data$ ls  
response.json  
vg@ubu20box:/var/lib/docker/volumes/my_volume/_data$ sudo vi response.json  
_Hello, **from VOLUME**! Now: - 11.06.2021 14:40:34_  

# mongo

В хабе есть монго, запускаем:  
vg@ubu20box:~/PycharmProjects/docker-am$ **docker run --rm -d -p 27017:27017 mongo**  
8f4995a206632770550e0501614c89d928d45391bc3a4ef1b2cca8dc1a10266a  
Скачалась, работает:  
vg@ubu20box:~/PycharmProjects/docker-am$ **docker ps**  
```
CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS         PORTS                                           NAMES  
8f4995a20663   mongo     "docker-entrypoint.s…"   14 seconds ago   Up 9 seconds   0.0.0.0:27017->27017/tcp, :::27017->27017/tcp   confident_spence
```

Запускаем приложение:
/usr/bin/python3.8 **/home/vg/PycharmProjects/docker-am/app-mongo.py**
```
{'_id': '1327e089-6156-4bb6-b703-1db440817def', 'payload': '7ac3eaed-45c3-4493-a177-dbb154decce9', 'field2': '1623516843'}
{'_id': 'd1da287f-2ccf-4030-8465-e752437b5e36', 'payload': '1f20bd49-e0a8-4dae-b306-ceb5814eab0e', 'field2': '1623516843'}
{'_id': 'aa45185d-0749-48b6-90c9-9da14200a518', 'payload': '9ec7f1eb-80d9-44cc-8b31-0c4e39ab47d3', 'field2': '1623516843'}
{'_id': '2614dab9-780c-4752-8794-546b95ebeaf2', 'payload': '12d6db19-b81c-4958-9fb6-9da6cb1c4a93', 'field2': '1623516843'}
{'_id': '4f4e7dd4-fa6a-41ba-8314-5bea349484d0', 'payload': '6a0f2319-77d5-4b31-a0f8-84d30b97842a', 'field2': '1623516843'}

Process finished with exit code 0
```

Удобно - имеем БД для отладки - не инстолии, не настраивали, получили из коробки (из образа)  
















